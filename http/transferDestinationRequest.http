### POST request to example server
POST http://localhost:8080/vapi4k
Content-Type: application/json

{
  "message": {
    "type": "transfer-destination-request",
    "call": {
      "id": "d64ab40e-d6ce-4cda-a8f1-e2194757c784",
      "orgId": "679a13ec-f40d-4055-8959-797c4ee1694b",
      "createdAt": "2024-08-11T04:58:29.026Z",
      "updatedAt": "2024-08-11T04:58:29.026Z",
      "type": "inboundPhoneCall",
      "status": "ringing",
      "phoneCallProvider": "twilio",
      "phoneCallProviderId": "CA2c9a04b3f68d5c10e9534499265fb3ce",
      "phoneCallTransport": "pstn",
      "phoneNumberId": "5a5a04dc-dcbe-45b1-8f64-fd32a253d135",
      "customer": {
        "number": "+19256836490"
      },
      "squad": {
        "name": "Flow Testing Squad",
        "members": [
          {
            "assistant": {
              "name": "Reception",
              "model": {
                "model": "gpt-4-turbo",
                "messages": [
                  {
                    "content": "\n[Identity]\nYou are the friendly and helpful voice of EO Care named Justin. Your goal is to transfer the user to the correct destination.\n\n[Style]\n\n- Be friendly and concise.\n- Talk slowly and clearly.\n- Use simple language.\n\n\n[Response Guideline]\n\n- Present dates in a clear format (e.g., 01/01/2024 or mm/dd/yyyy).\n- After asking a question, wait for the customer's response before proceeding.\n- If the user says they don't want to answer a question, tell them they have to until they do.\n- Whenever the relevant information is given, immediately call the corresponding service to save it.\n\n\n[Task]\n- Ask the user where they would like to go.\n- Transfer the user to the correct destination.\n\n",
                    "role": "system"
                  }
                ],
                "tools": [
                  {
                    "type": "transferCall"
                  }
                ],
                "provider": "openai"
              },
              "firstMessage": "Where would you like to go?"
            }
          },
          {
            "assistant": {
              "name": "Matthew",
              "model": {
                "model": "gpt-4-turbo",
                "messages": [
                  {
                    "content": "\n[Identity]\nYou are the friendly and helpful voice of EO Care named Renee. Your goal is to gather information about the customer's pain.\n\n[Style]\n\n- Be friendly and concise.\n- Talk slowly and clearly.\n- Use simple language.\n\n\n[Response Guideline]\n\n- Present dates in a clear format (e.g., 01/01/2024 or mm/dd/yyyy).\n- After asking a question, wait for the customer's response before proceeding.\n- If the user says they don't want to answer a question, tell them they have to until they do.\n- Whenever the relevant information is given, immediately call the corresponding service to save it.\n\n\n[Task]\n- Gather information about how much the customer's pain interfered with their daily activities.\n- Convert all answers into \"never\", \"rarely\", \"sometimes\", \"often\", or \"always\".\n\n",
                    "role": "system"
                  }
                ],
                "functions": [
                  {
                    "name": "getPainDTDInterference_0002",
                    "description": "Get how much pain interfered with daily activities",
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "painInterference": {
                          "description": "The painInterference parameter",
                          "type": "string"
                        }
                      },
                      "required": [
                        "painInterference"
                      ]
                    }
                  }
                ],
                "provider": "openai"
              },
              "voice": {
                "provider": "playht",
                "voiceId": "jennifer"
              },
              "firstMessage": "In the past 7 days, how much did pain interfere with your day to day activities? You can say\n                 \"never\", \"rarely\", \"sometimes\", \"often\", \"always\", or anything like that - we can pick it up if it's close.\n                "
            }
          },
          {
            "assistant": {
              "name": "Renee",
              "model": {
                "model": "gpt-4-turbo",
                "messages": [
                  {
                    "content": "\n[Identity]\nYou are the friendly and helpful voice of EO Care named Bella. Your goal is to gather information about what medication the customer is taking.\n\n[Style]\n\n- Be friendly and concise.\n- Talk slowly and clearly.\n- Use simple language.\n\n\n[Response Guideline]\n\n- Present dates in a clear format (e.g., 01/01/2024 or mm/dd/yyyy).\n- After asking a question, wait for the customer's response before proceeding.\n- If the user says they don't want to answer a question, tell them they have to until they do.\n- Whenever the relevant information is given, immediately call the corresponding service to save it.\n\n\n[Task]\n\n- When the customer responds with drug names, call the corresponding service and then keep asking them if there are more until they say they are done.\n- After that, ask \"Are you taking any of these medications? Say yes or no.\" and ask about each of the following medications.\n- Wait for the customer to respond to each question before moving to the next medication.\n- If the customer has said that they are taking a specific medication, do not list it again.\n- Clobazam\n- Duloxetine\n- Lorazepam\n- Alprazolam\n- Clonazepam\n- Clopidogrel\n- Warfarin\n- Summarize the medications they are taking.\n- Say thank you.\n\n",
                    "role": "system"
                  }
                ],
                "functions": [
                  {
                    "name": "saveMedication_003",
                    "description": "Save the medication the customer is taking",
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "medication": {
                          "description": "The medication parameter",
                          "type": "string"
                        }
                      },
                      "required": [
                        "medication"
                      ]
                    }
                  },
                  {
                    "name": "hasMedication_003",
                    "description": "Check if a medication is in the database",
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "medication": {
                          "description": "The medication parameter",
                          "type": "string"
                        }
                      },
                      "required": [
                        "medication"
                      ]
                    }
                  }
                ],
                "provider": "openai"
              },
              "voice": {
                "provider": "openai",
                "voiceId": "echo"
              },
              "firstMessage": "What medications are you taking?"
            }
          },
          {
            "assistant": {
              "name": "Justin",
              "model": {
                "model": "gpt-4-turbo",
                "messages": [
                  {
                    "content": "\n[Identity]\nYou are the friendly and helpful voice of EO Care named Kyla. Your goal is to gather information about the customer's activities.\n\n[Style]\n\n- Be friendly and concise.\n- Talk slowly and clearly.\n- Use simple language.\nTalk as slowly as possible\n\n[Response Guideline]\n\n- Present dates in a clear format (e.g., 01/01/2024 or mm/dd/yyyy).\n- After asking a question, wait for the customer's response before proceeding.\n- If the user says they don't want to answer a question, tell them they have to until they do.\n- Whenever the relevant information is given, immediately call the corresponding service to save it.\n\n\n[Task]\n- Ask the customer to describe what activities are important to them.\n- After each response, ask \"on a scale from 1 to 10, where 1 is not difficult and 10 is impossible,\nhow would you rate how much your symptoms are interfering with this activity?\".\n",
                    "role": "system"
                  }
                ],
                "functions": [
                  {
                    "name": "getActivity_004",
                    "description": "Get the activities that are important to the customer",
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "activity": {
                          "description": "The activity parameter",
                          "type": "string"
                        }
                      },
                      "required": [
                        "activity"
                      ]
                    }
                  },
                  {
                    "name": "getDifficulty_004",
                    "description": "Get the activities that are difficult for the customer",
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "difficulty": {
                          "description": "The difficulty parameter",
                          "type": "integer"
                        },
                        "activity": {
                          "description": "The activity parameter",
                          "type": "string"
                        }
                      },
                      "required": [
                        "difficulty",
                        "activity"
                      ]
                    }
                  }
                ],
                "provider": "openai"
              },
              "firstMessage": "Please share a few activities yada yada yada"
            }
          },
          {
            "assistant": {
              "name": "Bella",
              "model": {
                "model": "gpt-4-turbo",
                "messages": [
                  {
                    "content": "\n[Identity]\nYou are the friendly and helpful voice of EO Care named Justin. Your goal is to gather information about what medications customer's medication.\n\n[Style]\n\n- Be friendly and concise.\n- Talk slowly and clearly.\n- Use simple language.\n\n\n[Response Guideline]\n\n- Present dates in a clear format (e.g., 01/01/2024 or mm/dd/yyyy).\n- After asking a question, wait for the customer's response before proceeding.\n- If the user says they don't want to answer a question, tell them they have to until they do.\n- Whenever the relevant information is given, immediately call the corresponding service to save it.\n\n\n[Task]\n- Ask the customer to describe the medication they are taking.\n- If they respond with drug names, call the corresponding service and then keep asking them if there are more until they say they are done.\n- If they respond with classifications (heart medicine, blood thinner), call the corresponding service and then\nask them to provide examples of medications in that classification.\n\n",
                    "role": "system"
                  }
                ],
                "functions": [
                  {
                    "name": "getMedicationType_005",
                    "description": "Get the type of medication the customer is taking (e.g., heart medicine, blood thinner)",
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "medicationType": {
                          "description": "The medicationType parameter",
                          "type": "string"
                        }
                      },
                      "required": [
                        "medicationType"
                      ]
                    }
                  },
                  {
                    "name": "getMedication_005",
                    "description": "Get the medication the customer is taking",
                    "parameters": {
                      "type": "object",
                      "properties": {
                        "medication": {
                          "description": "The medication parameter",
                          "type": "string"
                        }
                      },
                      "required": [
                        "medication"
                      ]
                    }
                  }
                ],
                "provider": "openai"
              },
              "firstMessage": "What medications are you taking?"
            }
          }
        ]
      }
    },
    "phoneNumber": {
      "id": "5a5a04dc-dcbe-45b1-8f64-fd32a253d135",
      "orgId": "679a13ec-f40d-4055-8959-797c4ee1694b",
      "number": "+19254207621",
      "createdAt": "2024-06-29T03:03:00.576Z",
      "updatedAt": "2024-07-29T03:03:12.996Z",
      "stripeSubscriptionId": "sub_1PWrYyCRkod4mKy33cFxM9B7",
      "stripeSubscriptionStatus": "active",
      "stripeSubscriptionCurrentPeriodStart": "2024-07-29T03:02:56.000Z",
      "provider": "twilio"
    },
    "customer": {
      "number": "+19256836490"
    },
    "artifact": {
      "messages": [
        {
          "role": "bot",
          "message": "Where would you like to go?",
          "time": 1723352311765,
          "endTime": 1723352313465,
          "secondsFromStart": 1.1999999,
          "source": ""
        },
        {
          "role": "user",
          "message": "Transfer to Bella.",
          "time": 1723352314385,
          "endTime": 1.7233523159249998E12,
          "secondsFromStart": 3.82,
          "duration": 2.42
        },
        {
          "role": "bot",
          "message": "Transferring you now. Please hold.",
          "time": 1723352316865,
          "endTime": 1723352319455,
          "secondsFromStart": 6.3,
          "source": ""
        },
        {
          "role": "user",
          "message": "Transfer to Bella.",
          "time": 1723352331055,
          "endTime": 1723352332595,
          "secondsFromStart": 20.49,
          "duration": 2.58
        },
        {
          "toolCalls": [
            {
              "id": "call_P0PeVgn1hT8hWULTeghFtHCM",
              "type": "function",
              "function": {
                "name": "transferCall",
                "arguments": "{}"
              }
            }
          ],
          "role": "tool_calls",
          "message": "",
          "time": 1723352332333,
          "secondsFromStart": 21.99
        }
      ],
      "messagesOpenAIFormatted": [
        {
          "role": "assistant",
          "content": "Where would you like to go?"
        },
        {
          "role": "user",
          "content": "Transfer to Bella."
        },
        {
          "role": "assistant",
          "content": "Transferring you now. Please hold."
        },
        {
          "role": "user",
          "content": "Transfer to Bella."
        },
        {
          "role": "assistant",
          "tool_calls": [
            {
              "id": "call_P0PeVgn1hT8hWULTeghFtHCM",
              "type": "function",
              "function": {
                "name": "transferCall",
                "arguments": "{}"
              }
            }
          ]
        },
        {
          "role": "tool",
          "tool_call_id": "call_P0PeVgn1hT8hWULTeghFtHCM",
          "content": "undefined"
        }
      ]
    },
    "timestamp": "2024-08-11T04:58:52.342Z"
  }
}

###
